var async=require("async"),qs=require("querystring");module.exports=function(e,r,s){function n(e,s){var n={jql:e,maxResults:a,fields:"key"};o.url=i+qs.stringify(n),r.easyRequest.JSON(o,function(e,r){e?(u.error(e),s(e)):s(null,{count:r.issues.length,maxResults:a,url:t+qs.stringify(n),label:"Issues"})})}if(!e.server||!e.server.address)return s("No JIRA server configured");if(!e.server.username||!e.server.password)return s("No JIRA credentials found");if(!e.jqlOpen)return s("No JQL for issues");var u=r.logger,a=200,i=e.server.address+"/rest/api/2/search?",t=e.server.address+"/issues/?",o={headers:{authorization:"Basic "+new Buffer(e.server.username+":"+e.server.password).toString("base64")}};n(e.jqlOpen,s)};