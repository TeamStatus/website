widget={onData:function(a,s){function e(a){var s=0,e=$("<div/>").addClass("responsibles");return a.responsible.forEach(function(a){a.avatar&&(s++,$(e).append($("<img/>").attr({src:a.avatar,title:a.name})))}),{assigneeCount:s,responsiblesDiv:e}}function d(a){var s=$("<div/>").addClass("build").addClass("build-status").addClass(a.success);a.progress&&$(s).prepend($('<div class="build-progress"></div>').width(a.progress));var d=$("<div/>").addClass("build-info");if(a.down)d.append($("<div/>").addClass("plan-name").addClass("down").text(a.planName+" could not be accessed"));else{if(d.append($("<div/>").addClass("plan-name").append($("<a/>").attr("href",a.link).text(a.planName))),"failed"===a.success){var n=$("<div/>").addClass("fail-details"),i=a.failedTestCount>0?a.failedTestCount:"?";n.append($("<span/>").addClass("failed-tests-summary").text(i)),d.append(n)}if(a.isRefreshing){var l=$("<span/>").addClass("time-remaining"),r=a.timeRemaining||"";r.indexOf("slower than usual")>0&&(r="- "+r.replace("slower than usual",""),l.addClass("slower-than-usual")),l.text(r),d.append(l)}if("failed"===a.success){var p=e(a);1!=p.assigneeCount&&s.addClass("unassigned"),$(d).append(p.responsiblesDiv)}}return s.append(d),s}$(".build-overview-always-show",a).empty();var n=0,i=0,l=0;s.showBuilds.forEach(function(s){s.down?i++:"failed"===s.success?n++:l++,$(".build-overview-always-show",a).append(d(s))}),$(".build-breakers",a).empty(),s.failBuilds.forEach(function(e){var r=function(a){return a.planName===e.planName};e.down?_.find(s.showBuilds,r)||i++:"failed"===e.success?(_.find(s.showBuilds,r)||n++,$(".build-breakers",a).append(d(e))):_.find(s.showBuilds,function(a){return a.planName===e.planName})||l++});var r=_.uniq(s.failBuilds.concat(s.showBuilds),!1,function(a){return a.planKey}).length,p=r===i,t=parseInt(n/r*100,10);p&&(t=100),$(".fail-bar",a).width(t+"%"),p?$(".build-breakers",a).append($("<div/>").addClass("all-builds-down-message uppercase").append("ALL BAMBOO PLANS ARE DOWN")):0===n&&$(".build-breakers",a).append($("<div/>").addClass("no-broken-builds-message uppercase").append("NO BROKEN BUILDS"));var u="";u=n>0?n+"/"+r+" RED":r-i+" BUILDS GREEN",i>0&&(u+=" ("+i+" DOWN)"),$(".failed-report",a).html(u)}};