var assert=require("assert"),cheerio=require("cheerio"),buildoverview=require("../buildoverview");describe("buildoverview",function(){var e;beforeEach(function(s){e={interval:2e4,failBuilds:["CONFUI-QUNITFFESR","CONFUI-QUNITFFLATEST","CONFUI-QUNITCHROMEPLUGINS","CONFUI-QUNITCHROMELATEST","CONFUI-QUNITQCFFLATEST","CONFUI-QUNITQEFFLATEST11"],showBuilds:[],widgetTitle:"QUNIT BUILDS"},e.globalAuth={cbac:{username:"myusername",password:"secretpassword"}},s()}),describe("build_overview",function(){var e;beforeEach(function(s){e={interval:2e4,failBuilds:["CONFUI-QUNITFFESR","CONFUI-QUNITFFLATEST","CONFUI-QUNITCHROMEPLUGINS","CONFUI-QUNITCHROMELATEST","CONFUI-QUNITQCFFLATEST","CONFUI-QUNITQEFFLATEST11"],showBuilds:["COD-MSATP","COD"],widgetTitle:"QUNIT BUILDS",bamboo_server:"fake-one"},e.globalAuth={cbac:{username:"myusername",password:"secretpassword"}},s()}),it("should return array of data",function(s){var r={request:function(e,s){if(e.url.match(/fake-one\/rest\/api\/latest\/result\/[^-]+-[^-]+-latest.json/))s(null,{statusCode:200},'{ "key": "P-B-1" }');else if(e.url.match(/fake-one\/rest\/api\/latest\/result\/[^-]+-[^-]+-\d+.json/))s(null,{statusCode:404});else if(e.url.match(/fake-one\/browse\/[^-]+-[^-]+-\d+/))s(null,{statusCode:200},"");else{if(!e.url.match(/fake-one\/rest\/api\/latest\/result\/[^-]+.json/))throw console.log("request: ",e),"what?";s(null,{statusCode:200},'{ "results": { "result" : [] } }')}},logger:{error:function(e){assert.fail("Got unexpected error: "+e)}}},t=function(e,r){assert.equal(e,null),assert.ok(!r.error),assert.ok(r.showBuilds.length),assert.ok(r.failBuilds.length),assert.ok(!r.failBuilds[0].length),s()};buildoverview(e,r,t)})})});